---
title: "Zod + Honoã§TypeScript ã‚¹ã‚­ãƒ¼ãƒå®šç¾© & OpenAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ"
emoji: "ğŸƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [zod, hono, typescript]
published: true
published_at: 2025-02-05 09:00
publication_name: "ka_projects"
---

## 1. æœ¬ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã§ä½¿ã†ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- **Zod**  
  TypeScript å‘ã‘ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª  
  ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã‚’é€šã—ã¦å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼ã‚„å‹ã®æ¨è«–ãŒå¯èƒ½  
  ä¾‹: `z.object({...})` ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã€`z.string()`, `z.date()` ãªã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‹ã‚’æŒ‡å®šã™ã‚‹

- **@hono/zod-openapi**  
  Zod ã« OpenAPI ç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹: `example`ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä½ç½®æƒ…å ±ãªã©ï¼‰ã‚’ä»˜ä¸ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª  
  å®šç¾©ã—ãŸã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰è‡ªå‹•ã§ OpenAPI ã®ä»•æ§˜æ›¸ã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹  
  ä¾‹: `.openapi({ example: "å€¤" })` ã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒã‚§ãƒ¼ãƒ³ã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸Šã«ä¾‹ç¤ºå€¤ã‚’è¡¨ç¤ºã™ã‚‹

- **OpenAPI**  
  RESTful API ã®ä»•æ§˜ã‚’è¨˜è¿°ã™ã‚‹ãŸã‚ã®æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ  
  ã‚¹ã‚­ãƒ¼ãƒã« OpenAPI ç”¨ã®æƒ…å ±ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§ã€API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆSwagger ãªã©ï¼‰ã‹ã‚‰è‡ªå‹•ã§ä»•æ§˜æ›¸ã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

---

## 2. ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã®æµã‚Œ

1. **åŸºæœ¬ã¨ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚­ãƒ¼ãƒã®ä½œæˆ**  
   `z.object({ ... })` ã‚’ç”¨ã„ã¦ã€API ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©ã™ã‚‹  
   å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ `z.string()`, `z.date()`, `z.string().nullable()` ãªã©ã§å‹ã‚’æŒ‡å®šã™ã‚‹

2. **OpenAPI ç”¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ **  
   `.openapi({ example: "å€¤" })` ã‚’å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒã‚§ãƒ¼ãƒ³ã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¡¨ç¤ºã•ã‚Œã‚‹ä¾‹ã‚’è¨­å®šã™ã‚‹  
   ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã«åå‰ã‚’ä»˜ã‘ã‚‹å ´åˆã¯ `.openapi("SchemaName")` ã‚’ãƒã‚§ãƒ¼ãƒ³ã—ã€OpenAPI ã®ã‚¹ã‚­ãƒ¼ãƒåã¨ã—ã¦ç™»éŒ²ã™ã‚‹

3. **ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©**  
   å˜ä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãªãè¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™å ´åˆã€`z.array(...)` ã‚’ç”¨ã„ã¦é…åˆ—ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹

4. **ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©**  
   API ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚ `z.object({...})` ã§å®šç¾©ã™ã‚‹  
   `.openapi({ param: { name, in } })` ã‚’ä»˜ä¸ã—ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã©ã“ã«å­˜åœ¨ã™ã‚‹ã‹ï¼ˆin: "query" ãªã©ï¼‰ã‚’æ˜ç¤ºã™ã‚‹

---

## 3. ç´°ã‹ã„æ–‡æ³•ã®è§£èª¬

- **import { z } from "@hono/zod-openapi"**  
  Zod ã®é–¢æ•°ç¾¤ã‚’è¡¨ã™ z ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹  
  æ¨™æº–ã® Zod ã«åŠ ãˆã¦ã€OpenAPI ç”¨ã® `.openapi()` ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ‹¡å¼µã•ã‚Œã¦ã„ã‚‹

- **z.object({ ... })**  
  ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹  
  ä¸­æ‹¬å¼§ `{ ... }` å†…ã«å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã¨ãã®å‹ã®å®šç¾©ã‚’è¨˜è¿°ã™ã‚‹

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‹å®šç¾©ä¾‹**

  - `z.string()`  
    æ–‡å­—åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹
  - `z.string().nullable()`  
    æ–‡å­—åˆ—ã¾ãŸã¯ null ã‚’è¨±å®¹ã™ã‚‹ (string | null)
  - `z.string().nullish()`  
    æ–‡å­—åˆ—ã¾ãŸã¯ null, undefined ã‚’è¨±å®¹ã™ã‚‹ (string | null | undefined)
  - `z.date()`  
    æ—¥ä»˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹

- **.openapi({ ... }) ãƒ¡ã‚½ãƒƒãƒ‰**  
  ã‚¹ã‚­ãƒ¼ãƒã‚„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« OpenAPI ç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹  
  ä¾‹:

  ```ts
  z.string().openapi({
    example: "SomeExampleValue",
  });
  ```

  ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸Šã« `"SomeExampleValue"` ã¨ã„ã†ã‚µãƒ³ãƒ—ãƒ«å€¤ãŒè¡¨ç¤ºã•ã‚Œã‚‹

- **.openapi("SchemaName") ã®ä½¿ã„æ–¹**
  ã‚¹ã‚­ãƒ¼ãƒå®šç¾©å…¨ä½“ã«åå‰ã‚’ä»˜ä¸ã—ã€OpenAPI ä»•æ§˜æ›¸ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒã¨ã—ã¦ç™»éŒ²ã™ã‚‹
  ä¾‹:

  ```ts
  .openapi("GetSomethingSchema")
  ```

- **z.array(GetSomethingSchema)**
  é…åˆ—å†…ã®å„è¦ç´ ãŒç‰¹å®šã‚¹ã‚­ãƒ¼ãƒã«æº–æ‹ ã—ã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹

- **ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å®šç¾©ã§ã® .openapi({ param: { name, in } })**
  ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å›ºæœ‰ã®æƒ…å ±ã‚’è¿½åŠ ã™ã‚‹
  ä¾‹:
  ```ts
  z.string().openapi({
    param: {
      name: "someQueryParam",
      in: "query",
    },
    example: "SomeValue",
  });
  ```
  `someQueryParam` ã¨ã„ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ã«å­˜åœ¨ã—ã€ã‚µãƒ³ãƒ—ãƒ«å€¤ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«åæ˜ ã•ã‚Œã‚‹

---

## 4. å®šç¾©ä¾‹

ä»¥ä¸‹ã®ã‚ˆã†ãªå‹ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ã£ã¦ãã‚‹ã“ã¨ã‚’æƒ³å®šã™ã‚‹ã¨ã™ã‚‹

```ts
export type SomethingProps = {
  kind: string;
  docId: string;
  containerId: string;
  resourceId: string;
  resourceName: string;
  routeId: string;
  routeName: string;
  versionId: string | null;
  versionName: string | null;
  datePublished: string | null;
  imageUrl: string;
  createdTime: Date | null;
  updatedTime: Date | null;
};
```

å®Ÿéš›ã«ä½œæˆã—ãŸã‚¹ã‚­ãƒ¼ãƒä¾‹

```ts
import { z } from "@hono/zod-openapi";
import { SomeOtherSchema } from "./some-other";

export const GetSomethingSchema = z
  .object({
    kind: z.string().openapi({ example: "Kind" }),
    docId: z.string().nullable().openapi({ example: "DocId" }),
    containerId: z.string().nullable().openapi({ example: "ContainerId" }),
    resourceId: z.string().openapi({ example: "ResourceId" }),
    resourceName: z.string().openapi({ example: "ResourceName" }),
    routeId: z.string().nullable().openapi({ example: "RouteId" }),
    routeName: z.string().openapi({ example: "RouteName" }),
    versionId: z.string().nullable().openapi({ example: "VersionId" }),
    versionName: z.string().nullable().openapi({ example: "VersionName" }),
    datePublished: z.string().nullable().openapi({ example: "DatePublished" }),
    imageUrl: z.string().nullable().openapi({ example: "ImageUrl" }),
    createdTime: z.date().nullable().openapi({ example: "CreatedTime" }),
    updatedTime: z.date().nullable().openapi({ example: "UpdatedTime" }),
  })
  .openapi("GetSomethingSchema");

export const GetSomethingResponseSchema = z
  .array(GetSomethingSchema)
  .openapi("GetSomethingResponseSchema");

export const GetSomethingQueryParamsSchema = z.object({
  resourceName: z.string().openapi({
    param: {
      name: "resourceName",
      in: "query",
    },
    example: "ã‚µãƒ³ãƒ—ãƒ«ãƒªã‚½ãƒ¼ã‚¹å",
  }),
  routeId: z.string().openapi({
    param: {
      name: "routeId",
      in: "query",
    },
    example: "ã‚µãƒ³ãƒ—ãƒ«ãƒ«ãƒ¼ãƒˆ",
  }),
});
```

### GetSomethingSchema, GetSomethingResponseSchema, GetSomethingQueryParamsSchema ã®å½¹å‰²

- **GetSomethingSchema**
  å˜ä¸€ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¡¨ã™ã‚¹ã‚­ãƒ¼ãƒ
  å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å¯¾ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚µãƒ³ãƒ—ãƒ«å€¤ã®æŒ‡å®šã‚’è¡Œã†
  å†…éƒ¨å‡¦ç†ã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆæ™‚ã«ã€ã“ã®ã‚¹ã‚­ãƒ¼ãƒã«é©åˆã—ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹

- **GetSomethingResponseSchema**
  API ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å…¨ä½“ã‚’è¡¨ã™ã‚¹ã‚­ãƒ¼ãƒ
  `z.array(GetSomethingSchema)` ã¨ã—ã¦å®šç¾©ã•ã‚Œã€è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé…åˆ—ï¼‰ã‚’è¿”ã™ã“ã¨ã‚’ç¤ºã™
  é…åˆ—å½¢å¼ã§ã‚ã‚Šã€å„è¦ç´ ãŒ `GetSomethingSchema` ã«å¾“ã£ã¦ã„ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹

- **GetSomethingQueryParamsSchema**
  ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ¸¡ã•ã‚Œã‚‹ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹ã‚¹ã‚­ãƒ¼ãƒ
  ä¾‹ã§ã¯ `resourceName`, `routeId` ãªã©ã‚’å®šç¾©ã—ã€OpenAPI ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã€ä½ç½®ã€ã‚µãƒ³ãƒ—ãƒ«å€¤ï¼‰ã‚’ä»˜ä¸ã—ã¦ã„ã‚‹
  ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼ã¨è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”ŸæˆãŒå¯èƒ½ã«ãªã‚‹

&nbsp;
&nbsp;
&nbsp;
&nbsp;
ä»¥ä¸Šã§ã™ã€‚
